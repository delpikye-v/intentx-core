"use strict";let e=0;function t(t){return Symbol(null!=t?t:"scope-"+ ++e)}const n={activeNode:null,nodes:new Set};let o=0;function c(e){const t={id:++o,type:e,deps:new Set};return n.nodes.add(t),t}function r(e,t){e.deps.add(t)}const l="undefined"==typeof globalThis||void 0===globalThis.__DEV__||globalThis.__DEV__;const i={high:new Set,normal:new Set,low:new Set};let a=!1;function s(){a=!0;for(const e of["high","normal","low"])for(const t of i[e])i[e].delete(t),t();a=!1}function u(e,t="normal"){i[t].add(e),a||queueMicrotask(s)}function f(){const e={activeEffect:null,activeDeps:null},t=function(e,t){return function(o){let i=o;const a=new Set,s=l?c("signal"):null,u=()=>{var t;const o=e.activeEffect;if(o&&(a.add(o),null===(t=e.activeDeps)||void 0===t||t.add(a)),l&&s){const e=n.activeNode;e&&r(e,s)}return i};return u.set=(n,o="normal")=>{Object.is(n,i)||(i=n,a.forEach(n=>{n!==e.activeEffect&&t(n,o)}))},u.subscribe=e=>(a.add(e),()=>a.delete(e)),u}}(e,u),o=function(e,t){return function(o){let i,a=!0;const s=new Set,u=new Set,f=l?c("computed"):null,d=()=>{a||(a=!0,s.forEach(e=>t(e,"normal")))};return()=>{var t;const c=e.activeEffect;if(c&&(s.add(c),null===(t=e.activeDeps)||void 0===t||t.add(s)),a){for(const e of u)e.delete(d);u.clear();const t=e.activeEffect,c=e.activeDeps,r=l?n.activeNode:null;e.activeEffect=d,e.activeDeps=u,l&&f&&(n.activeNode=f);try{i=o(),a=!1}finally{e.activeEffect=t,e.activeDeps=c,l&&(n.activeNode=r)}}if(l&&f){const e=n.activeNode;e&&r(e,f)}return i}}}(e,u),i=function(e,t){return function(o,r="normal"){let i=!1;const a=new Set,s=l?c("effect"):null,u=()=>{if(i)return;for(const e of a)e.delete(u);a.clear();const t=l?n.activeNode:null;try{e.activeEffect=u,e.activeDeps=a,l&&s&&(n.activeNode=s),o()}finally{e.activeEffect=null,e.activeDeps=null,l&&(n.activeNode=t)}};return t(u,r),()=>{i=!0;for(const e of a)e.delete(u);a.clear()}}}(e,u);return{signal:t,createComputed:o,reactiveEffect:i,context:e}}const d=f(),v=d.signal,p=d.createComputed,w=d.reactiveEffect,g=d.createComputed,h=d.reactiveEffect,m=new Set;let E="low";const y=t("default");exports.batch=function(e){try{e()}finally{for(const e of m)u(e,E);m.clear(),E="low"}},exports.computed=g,exports.createComputed=p,exports.createIntentBus=function(e){const t=new Map,n=new Map,o=e=>null!=e?e:y;return{on(e,n,c){const r=o(c),l=function(e,n){var o,c;const r=null!==(o=t.get(e))&&void 0!==o?o:new Map,l=null!==(c=r.get(n))&&void 0!==c?c:new Set;return r.set(n,l),t.set(e,r),l}(e,r);return l.add(n),()=>{var o;l.delete(n),l.size||null===(o=t.get(e))||void 0===o||o.delete(r)}},effect(e,t,c){const r=function(e,t){var o,c;const r=null!==(o=n.get(e))&&void 0!==o?o:new Map,l=null!==(c=r.get(t))&&void 0!==c?c:[];return r.set(t,l),n.set(e,r),l}(e,o(c));return r.push(t),()=>{const e=r.indexOf(t);0>e||r.splice(e,1)}},async emit(c,r,l){var i,a,s;const u=o(l),f=null===(i=t.get(c))||void 0===i?void 0:i.get(u);if(!(null==f?void 0:f.size))return;const d=e(r,u),v=(null!==(s=null===(a=n.get(c))||void 0===a?void 0:a.get(u))&&void 0!==s?s:[]).reduceRight((e,t)=>t(e),async e=>{for(const t of f)await t(e)});await v(d)},scope:y}},exports.createReactiveRuntime=f,exports.createScope=t,exports.effect=h,exports.intentEffect=function(){const e=[],t=()=>t=>e.reduceRight((e,t)=>t(e),t);return t.takeLatest=()=>{let n=null;return e.push(e=>async t=>(null==n||n.abort(),n=new AbortController,e({...t,signal:n.signal}))),t},t.takeLeading=()=>{let n=!1;return e.push(e=>async t=>{if(!n){n=!0;try{return await e(t)}finally{n=!1}}}),t},t.debounce=n=>{let o;return e.push(e=>t=>new Promise(c=>{clearTimeout(o),o=setTimeout(()=>c(e(t)),n)})),t},t.throttle=n=>{let o=0;return e.push(e=>async t=>{const c=Date.now();if(c-o>=n)return o=c,e(t)}),t},t},exports.reactiveEffect=w,exports.schedule=u,exports.signal=v;
